#include <bits/stdc++.h>using namespace std;#define int long long  int32_t main(){    ios_base::sync_with_stdio(false);cin.tie(0);cout.tie(0);    int t; cin>>t;     while (t--){        int n,k; cin>>n>>k;        vector <int> v(n);        map <int,int> mp,m;        bool tar=false;                for (int i=0; i<n; i++){            cin>>v[i];            mp[v[i]]++;            }         for (auto [i,j] : mp){            if(j%k!=0){cout<<0<<"\n";tar=true;break;}            mp[i]/=k;        }                if (tar){continue;}         int ans=0;        for (int r=0,l=0; r>=l and r<n; r++){            m[v[r]]++;            while (m[v[r]]>mp[v[r]]){               m[v[l]]--;               l++;            }            ans+=(r-l+1);        }       cout << ans << "\n";    }        return 0;}